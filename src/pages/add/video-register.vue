<template>
  <q-page class="">

    <loginModal ref="loginModal" @callback-login="callbackLogin" />
    <personalInfoPolicyModal ref="personalInfoPolicyModal" />
    <termOfServiceModal ref="termOfServiceModal" />
    <redirectModal ref="redirectModal" />

    <q-layout-header>
      <q-toolbar color="black" inverted align="center">
        <q-btn @click="goBack" flat round dense icon="fast_rewind" />
        <q-toolbar-title><b>ğŸ”¥ OPEN EVENT ğŸ”¥</b></q-toolbar-title>
        <!-- <img @click="goBack" src="statics/images/logo/widelogo.png" style="width: 80px;">&nbsp;&nbsp; -->
        <q-btn @click="goBack" flat round dense icon="home" />
      </q-toolbar>
    </q-layout-header>

    <div class="no_refresh" style="width: 100%" >

      <!--
      <q-card-separator />
      <br>
      <div align="center">
        <br>
        <div class="q-display-1 q-mb-md text-grey">êµ³ì–´ë²„ë¦° ì‡¼í•‘ ë¬¸í™”</div>
        <p class="caption">
          <br>
          ì¸í„°ë„· ì‡¼í•‘ ë¬¸í™”ê°€ ë„ˆë¬´ ë”±ë”±í•˜ë‹¤.<br>
          ê°€ì¥ ì‹¼ ì œí’ˆì„ ë¹ ë¥´ê²Œ ë°°ì†¡ë°›ëŠ”ê²Œ ì „ë¶€ì¸..<br>
          <br>
          ì‡¼í•‘ë¬¸í™”ë¥¼ ë°”ê¿”ë³´ë ¤í•œë‹¤.<br>
          <br>
          ë‚˜ì˜ ì‡¼í•‘ì´ ì•„ë‹Œ<br>
          ìš°ë¦¬ì˜ ì‡¼í•‘ì´ ë  ìˆ˜ ìˆë„ë¡.<br>
          <br>
        </p>
      </div>
      <q-card-separator />

      <br>
      <div align="center">
        <br>
        <div class="q-display-1 q-mb-md text-grey">íš¨ìœ¨?</div>
        <p class="caption">
          <br>
          ìœ í†µ ë‹¨ê³„ë¥¼ ì¤„ì—¬ ë‹¨ê°€ë¥¼ ë‚®ì¶”ëŠ” ê²ƒì´<br>
          ê³¼ì—° ìµœìƒì±…ì¼ê¹Œ?<br>
          <br>
          ì‹¸ë‹¤ê³  ë¬´ì¡°ê±´ ì‚¬ëŠ” ê²ƒë„ ì•„ë‹ˆê³ <br>
          ë¹„ì‹¸ë‹¤ê³  ë¬´ì¡°ê±´ ì•ˆì‚¬ëŠ” ê²ƒ ë˜í•œ ì•„ë‹ˆë‹¤.<br>
          <br>
          ë‚˜ì˜ ì‡¼í•‘ì´ ì•„ë‹Œ<br>
          ìš°ë¦¬ì˜ ì‡¼í•‘ì´ ë  ìˆ˜ ìˆë„ë¡.<br>
          <br>
        </p>
        <br>
      </div>
      -->
      <table width="95%" border="0" align="center">
        <tr>
          <td align="center">
            <q-chip style="width:100%; height:20px; text-align:left; margin-top:0px;" color="black" tag dense pointing="down">
              &nbsp;ìœ íŠœë¸Œ ë™ì˜ìƒ ë“±ë¡
            </q-chip>
          </td>
        </tr>
      </table>

      <table width="90%" border="0" align="center">
        <tr>
          <td colspan="2">
            <q-input id="videoUrlOriginal" v-model.trim="contentsVo.video_url_original" stack-label="ìœ íŠœë¸Œ ë™ì˜ìƒ ì£¼ì†Œ" color="white" inverted-light clearable />
            <input type="hidden" v-model="contentsVo.video_cd">
            <input type="hidden" v-model="contentsVo.video_url">
            <br>
          </td>
        </tr>
        <tr>
          <td colspan="2" align="center">
            <q-btn icon="done" :loading="loading" :percentage="percentage" color="primary" @click="checkForm" style="width:50%;" outline rounded>
              &nbsp;&nbsp;&nbsp;&nbsp;ë“±ë¡í•˜ê¸°
              <span slot="loading">
                <q-spinner-oval class="on-left" />
                ë“±ë¡ì¤‘...&nbsp;&nbsp;&nbsp;
              </span>
            </q-btn>
            <br>
          </td>
        </tr>
      </table>
      <br>

      <table width="95%" border="0" align="center">
        <tr>
          <td align="center">
            <q-chip style="width:100%; height:20px; text-align:left; margin-top:0px;" color="black" tag dense pointing="down">
              &nbsp;ì´ë²¤íŠ¸ ë‚´ìš©
            </q-chip>
          </td>
        </tr>
      </table>

      <table width="90%" border="0" align="center">
        <tr>
          <td>
            ì¼ëª…, '<b>ë°±ì›ë”</b>' ì´ë²¤íŠ¸!<br><br>
            ìœ íŠœë¸Œ ë™ì˜ìƒ ë§í¬ë¥¼ ë“±ë¡ë§Œ í•˜ë©´<br><br>
            <font color="red">ë§í¬ 1ê°œë‹¹ ğŸ’¯ì›ë”ì”© ë³´ìƒì´! ğŸ‘</font><br>
            <br>
          </td>
        </tr>
      </table>

      <table width="95%" border="0" align="center">
        <tr>
          <td align="center">
            <q-chip style="width:100%; height:20px; text-align:left; margin-top:0px;" color="black" tag dense pointing="down">
              &nbsp;ì°¸ì—¬ ë°©ë²•
            </q-chip>
          </td>
        </tr>
      </table>

      <table width="90%" border="0" align="center">
        <tr>
          <td>
            â‘  ìœ íŠœë¸Œì—ì„œ ë™ì˜ìƒì˜ '<font color="red">ê³µìœ </font>'ë¥¼ ëˆ„ë¥´ê³ <br>
            <br>â‘¡ '<font color="red">ì£¼ì†Œ ë³µì‚¬</font>'ë¥¼ ì„ íƒí•œ í›„<br>
            <br>â‘¢ ìœ„ 'ìœ íŠœë¸Œ ë™ì˜ìƒ ì£¼ì†Œ'ì— <font color="red">ë¶™ì—¬ë„£ê¸°</font>.<br>
            <br>â‘£ <font color="red">ë“±ë¡í•˜ê¸°</font>. ë! &nbsp; ğŸ’¯ì›ë” ê²Ÿ!!!<br><br>
          </td>
        </tr>
      </table>

      <table width="95%" border="0" align="center">
        <tr>
          <td align="center">
            <q-chip style="width:100%; height:20px; text-align:left; margin-top:0px;" color="black" tag dense pointing="down">
              &nbsp;ê¸°íƒ€
            </q-chip>
          </td>
        </tr>
      </table>

      <table width="90%" border="0" align="center">
        <tr>
          <td>
            ìŒì•…ê³¼ ë³´ìƒì´ ìˆëŠ”<br>
            ì‡¼í•‘ì˜ ë‰´íŒ¨ëŸ¬ë‹¤ì„ ë©”íƒ€ìƒµìŠ¤.<br>
            ì´ì œëŠ” ì‡¼í•‘ë„ ìŠ¤í† ë¦¬ë‹·!<br>
            <br>
            <q-btn color="primary" @click="goIntroduce" style="width:120px;" size="sm" rounded><font size="3">ì›ë”í•™ê°œë¡ </font></q-btn>
            <br>
            <br>
            <font size="2" color="grey">â€» ì›ë”ëŠ” ë©”íƒ€ìƒµìŠ¤ì˜ ìºì‹œë¡œ, 100ì›ë”ëŠ” 100ì›ê³¼ ê°™ìŠµë‹ˆë‹¤.</font><br>
            <font size="2" color="grey">â€» ëª©í‘œ ë³´ìƒê¸ˆì•¡ ì†Œì§„ ì‹œ ì¡°ê¸°ì¢…ë£Œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</font><br><br>
          </td>
        </tr>
      </table>

      <table width="90%" border="0" align="center">
        <tr>
          <td align="center" width="50%">
            <q-btn color="primary" icon="play_arrow" @click="showYoutube" outline style="width:100%;">&nbsp;&nbsp;&nbsp;ìœ íŠœë¸Œ ë°©ë¬¸</q-btn>
          </td>
          <td align="center" width="50%">
            <q-btn color="primary" icon="share" @click="copyUrl" outline style="width:100%;">&nbsp;&nbsp;&nbsp;ê³µìœ í•˜ê¸°</q-btn>
          </td>
        </tr>
        <tr>
          <td colspan="2" align="left">&nbsp;</td>
        </tr>
      </table>

      <!--
      <table width="90%" border="0" align="center">
        <tr>
          <td colspan="2" align="left">&nbsp;</td>
        </tr>
        <tr>
          <td colspan="2" align="center"><a @click="getApp('android')"><img src="statics/images/btn/bt_googleplay.png"></a></td>
        </tr>
        <tr>
          <td colspan="2" align="left"></td>
        </tr>
        <tr>
          <td colspan="2" align="center"><a @click="getApp('ios')"><img src="statics/images/btn/bt_appstore.png"></a></td>
        </tr>
      </table>
      -->
      <br>
      <br>
      <br>
      <br>
      <br>
      <br>
      <br>

      <!-- ì‚¬ì—…ìì •ë³´ -->
      <q-collapsible>
        <!-- ì œëª© -->
        <template slot="header">
          <q-chip color="black" small class="q-mr-sm"><font size="1">ì‚¬ì—…ìì •ë³´</font></q-chip>
          <q-item-main label="" />
          <q-item-side right>
            <!-- <font size="1">ë³´ê¸°</font> -->
          </q-item-side>
        </template>
        <!-- ë‚´ìš© -->
        <table width="100%" align="center" border="0">
          <!--
          <tr>
            <td align="left" colspan="5" width="60"><img src="statics/images/oneon/oneonlogo.png" style="width:40px;"></td>
          </tr>
          -->
          <tr>
            <td align="left" colspan="5">
              <font size="1" color="black"><b>ì£¼ì‹íšŒì‚¬ í´ë ˆì´ìŠ¤íƒ€</b></font><br>
              <font size="1" color="grey">
                (04206) ì„œìš¸íŠ¹ë³„ì‹œ ë§ˆí¬êµ¬ ë§ˆí¬ëŒ€ë¡œ 196 1707í˜¸<br>
                ëŒ€í‘œì´ì‚¬ : ì•ˆì˜ëŒ€ | metashopse@gmail.com<br>
                í†µì‹ íŒë§¤ì—…ì‹ ê³  :2022-ì„œìš¸ë§ˆí¬-1213<br>
                ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ : 139-87-02383 &nbsp;<a @click="goBusinessInfo"><b>ì‚¬ì—…ìì •ë³´í™•ì¸</b></a><br>
                ê³ ê°ì„¼í„° :010-9394-1941 | ì´ë©”ì¼ : metashopse@gmail.com<br>
                <a @click="showTermOfService"><b>ì´ìš©ì•½ê´€</b></a>&nbsp;
                <a @click="showPersonalInfoPolicy"><b>ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</b></a>&nbsp;
                <!-- <a @click="goTerms"><b>ì•½ê´€ ë° ì •ì±…</b></a> -->
              </font>
            </td>
          </tr>
          <tr>
            <td colspan="5" align="left">
              <font size="1" color="grey">
                <!-- (ì£¼)í´ë ˆì´ìŠ¤íƒ€ëŠ” í†µì‹ íŒë§¤ì¤‘ê°œìë¡œì„œ ì˜¤í”ˆë§ˆì¼“ metashopse.comì˜ ê±°ë˜ë‹¹ì‚¬ìê°€ ì•„ë‹ˆë©°, íŒë§¤ìê°€ ë“±ë¡í•œ ìƒí’ˆì •ë³´ ë° ê±°ë˜ì— ëŒ€í•´ ì¼ì²´ ì±…ì„ì„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤. -->
              </font>
            </td>
          </tr>
          <tr>
            <td colspan="5">&nbsp;</td>
          </tr>
          <tr>
            <td align="center" colspan="5" width="60">
              <!-- KBì—ìŠ¤í¬ë¡œ ì´ì²´ ì¸ì¦ë§ˆí¬ -->
              <img src="http://img1.kbstar.com/img/escrow/escrowcmark.gif" @click="onPopKBAuthMark" style="width:30px;" />
              &nbsp;
              <!-- ì´ë‹ˆì‹œìŠ¤ ì¸ì¦ë§ˆí¬ -->
              <img src="statics/images/logo/ini_pay.png" style="width:30px;" />
            </td>
          </tr>
        </table>
      </q-collapsible>
      <!-- <q-card-separator /> -->
      <br>
      <!-- ì €ì‘ê¶Œ -->
      <table width="100%" align="center" border="0">
        <tr>
          <td align="center">
            <font size="1" color="grey">
              Copyright Â© OneOn Inc. All Rights Reserved.
            </font>
          </td>
        </tr>
      </table>
      <br>
    </div>

  </q-page>
</template>

<style>
</style>

<script>
import Vue from 'vue'

export default {
  name: 'contents-register',
  data () {
    return {
      loading: false,
      percentage: 0,
      contentsVo: {
        seq: '',
        video_cd: 'youtube',
        video_url_original: '',
        video_url: '',
        reg_id: ''
      }
    }
  },
  created: function () {
  },
  methods: {
    checkForm () { // ë“±ë¡ ì „ ì •í•©ì„± ì²´í¬
      if (this.contentsVo.video_url_original === '') {
        this.$q.notify({
          color: 'primary',
          position: 'top',
          message: 'ìœ íŠœë¸Œ ë™ì˜ìƒ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.',
          icon: 'notifications_active'
        })
        return
      }

      // ë™ì˜ìƒ ë§í¬ ì„¤ì •
      let originalVideoUrl = this.contentsVo.video_url_original
      if (originalVideoUrl !== '') {
        originalVideoUrl = originalVideoUrl.toString()
        if (originalVideoUrl.indexOf('youtube') > 0 || originalVideoUrl.indexOf('youtu.be') > 0) { // youtubeì¸ ê²½ìš°
          let arrUrl = originalVideoUrl.split('/')
          this.contentsVo.video_url = 'https://www.youtube.com/embed/' + arrUrl[arrUrl.length - 1]
          this.contentsVo.video_cd = 'youtube'
        } else {
          this.$q.notify({
            color: 'primary',
            position: 'top',
            message: 'ìœ íŠœë¸Œ ë™ì˜ìƒ ì£¼ì†Œë§Œ ë“±ë¡í•´ì£¼ì„¸ìš”.',
            icon: 'notifications_active'
          })
          return
        }
      }

      // ë¡œê·¸ì¸ ì²´í¬
      if (!Vue.prototype.$checkLogin(this.$store.state.userVo)) {
        // ì¿ í‚¤ì— ëŒì•„ì˜¬ íŒ¨ìŠ¤ ì €ì¥
        this.$cookie.set('LOGIN_REDIRECT_URL', '/add/video', 1)
        this.$refs.loginModal.show()
        return
      }

      // ë“±ë¡ ì²˜ë¦¬ ì‹œì‘
      this.insertContents()
    },
    insertContents () {
      this.loading = true

      // ì»¨í…ì¸  ë“±ë¡
      this.$axios({
        url: this.$store.state.apiServerIp + '/api/contents/insertContents',
        method: 'POST',
        data: this.contentsVo })
        .then((result) => {
          this.loading = false // ë“±ë¡ ë²„íŠ¼ ì•¡ì…˜ ì¤‘ë‹¨
          this.$q.notify({
            color: 'blue',
            position: 'top',
            message: 'ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.',
            icon: 'notifications_active'
          })
          this.$router.push('/menu/event') // ì´ë²¤íŠ¸ ë¦¬ìŠ¤íŠ¸ë¡œ ì´ë™
        })
        .catch((err) => {
          console.log(err)
          // this.$q.notify(err)
          this.loading = false // ë“±ë¡ ë²„íŠ¼ ì•¡ì…˜ ì¤‘ë‹¨
          this.$q.notify({
            color: 'primary',
            position: 'top',
            message: 'ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.',
            icon: 'notifications_active'
          })
        })
    },
    // â–  ë¡œê·¸ì¸ ì½œë°±
    callbackLogin () {
      // ë¡œê·¸ì¸ í›„ ì•¡ì…˜
      // ë“±ë¡ ì²˜ë¦¬ ì‹œì‘
      this.insertContents()
    },
    // ìœ íŠœë¸Œ ë§í¬
    showYoutube () {
      if (this.$store.state.device === 'android') {
        window.open('intent://m.youtube.com#Intent;scheme=http;package=com.google.android.youtube;end', '_blank')
      } else if (this.$store.state.device === 'ios') {
        try {
          window.open('youtube://m.youtube.com', '_blank')
        } catch (e) {
          window.open('https://m.youtube.com', '_blank')
        }
      } else {
        window.open('https://m.youtube.com', '_system', 'location=yes,footer=yes')
      }
    },
    getApp (os) {
      if (os === 'android') {
        window.open('https://play.google.com/store/apps/details?id=kr.oneon.sellerz')
      } else {
        window.open('https://apps.apple.com/kr/app/ec-9b-90-eb-8d-94-ec-83-b5/id1462604983')
      }
    },
    goIntroduce () {
      this.$router.push('/menu/introduce')
    },
    // í´ë¦½ì•„íŠ¸ë¡œ ë³µì‚¬í•˜ê¸°
    copyUrl () {
      this.$copyText('https://metashopse.com/event1').then(function (e) {
        console.log(e)
        // alert('ë§í¬ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆìŠµë‹ˆë‹¤.')
      }, function (e) {
        console.log(e)
        alert('ë³µì‚¬ ì‹¤íŒ¨')
      })
      this.$q.notify({
        color: 'blue',
        position: 'top',
        message: 'ì£¼ì†Œë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆìŠµë‹ˆë‹¤.',
        icon: 'notifications_active'
      })
    },
    // ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨
    showPersonalInfoPolicy () {
      this.$refs.personalInfoPolicyModal.show()
    },
    // ì„œë¹„ìŠ¤ ì´ìš© ì•½ê´€
    showTermOfService () {
      this.$refs.termOfServiceModal.show()
    },
    // ì‚¬ì—…ìì •ë³´í™•ì¸
    goBusinessInfo () {
      /*
      this.$refs.redirectModal.title = 'ì‚¬ì—…ìì •ë³´'
      this.$refs.redirectModal.url = this.$store.state.BUSINESS_SITE_INFO
      this.$refs.redirectModal.icon = 'play_arrow'
      this.$refs.redirectModal.show()
      */
      window.open(this.$store.state.BUSINESS_SITE_INFO, '_system')
    },
    // KBêµ­ë¯¼ì€í–‰ ì—ìŠ¤í¬ë¡œ í™•ì¸
    onPopKBAuthMark () {
      this.$refs.redirectModal.title = 'ì—ìŠ¤í¬ë¡œ'
      this.$refs.redirectModal.url = 'http://escrow1.kbstar.com/quics?page=B009111&cc=b010807:b008491&mHValue=ad1485447ff247d7f537f7db37de7148201905261237657'
      this.$refs.redirectModal.icon = 'play_arrow'
      this.$refs.redirectModal.show()
    },
    // ì•½ê´€ ë° ì •ì±…
    goTerms () {
      // this.$router.push('/terms')
    },
    goBack () {
      // ë¡œê·¸ì¸ ì²´í¬
      if (!Vue.prototype.$checkLogin(this.$store.state.userVo)) {
        // ì¿ í‚¤ì— ëŒì•„ì˜¬ íŒ¨ìŠ¤ ì €ì¥
        this.$cookie.set('LOGIN_REDIRECT_URL', '/add/video', 1)
        this.$refs.loginModal.show()
        return
      }

      try {
        // ë¼ìš°í„° ë°± íŒ¨ìŠ¤ ì„¤ì •
        let path = this.$store.state.ROUTER_FROM_PATH[this.$store.state.ROUTER_FROM_PATH.length - 1]
        // ë¼ìš°í„° ë°± íŒ¨ìŠ¤ 1ê°œ ì‚­ì œ
        this.$store.state.ROUTER_FROM_PATH.splice(this.$store.state.ROUTER_FROM_PATH.length - 1, 1)
        // ë’¤ë¡œê°€ê¸° ì—¬ë¶€ - trueì¼ ê²½ìš° ë¼ìš°í„° íŒ¨ìŠ¤ë¥¼ ì €ì¥ ì•ˆí•¨, goBack() í•¨ìˆ˜ ë‚´ì—ì„œ trueë¡œ ì„¤ì •, ë¼ìš°í„°ì—ì„œ falseë¡œ ì´ˆê¸°í™”
        this.$store.state.ROUTER_IS_MOVE_BACK = true
        // ë¼ìš°í„° ë°± íŒ¨ìŠ¤ë¡œ ì´ë™
        this.$router.push(path)
      } catch (e) {
        this.$router.push('/menu/event')
      }
    }
  }
}
</script>
<style>
</style>
